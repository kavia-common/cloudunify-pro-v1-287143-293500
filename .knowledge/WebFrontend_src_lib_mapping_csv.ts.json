{"is_source_file": true, "format": "TypeScript", "description": "This file provides functions to parse CSV data into structured resource and cost row objects, using PapaParse for CSV parsing and Zod schemas for validation. It includes normalization and coercion of fields, with support for parsing JSON strings within CSV fields.", "external_files": ["./schemas"], "external_methods": ["Papa.parse", "normalizeHeader", "parseNumberLike", "toIsoDate", "tryParseJson", "formatZodErrors", "ResourceIngestRowSchema", "CostIngestRowSchema"], "published": ["parseCsvTextResource", "parseCsvTextCost", "parseCsvResource", "parseCsvCost"], "classes": [], "methods": [{"name": "function toRowNumber(indexZeroBased: number): number { toRowNumber", "description": "Converts zero-based index to a 1-based row number including header.", "scope": "", "scopeKind": ""}, {"name": "function normalizeKeys(row: Record<string, unknown>): Record<string, unknown> { normalizeKeys", "description": "Normalizes object keys by trimming and converting headers to a standard format.", "scope": "", "scopeKind": ""}, {"name": "function coerceResourceCandidate(candidate: Record<string, unknown>): Record<string, unknown> { coerceResourceCandidate", "description": "Coerces fields of a resource candidate object to expected types.", "scope": "", "scopeKind": ""}, {"name": "function coerceCostCandidate(candidate: Record<string, unknown>): Record<string, unknown> { coerceCostCandidate", "description": "Coerces fields of a cost candidate object to expected types.", "scope": "", "scopeKind": ""}, {"name": "function parseCsvText(text: string): Array<Record<string, unknown>> { parseCsvText", "description": "Parses CSV text into an array of record objects.", "scope": "", "scopeKind": ""}, {"name": "export async function parseCsvTextResource(text: string): Promise<ParseResult<ResourceIngestRow>/ parseCsvTextResource", "description": "Public function to parse CSV text into validated resource rows with error reporting.", "scope": "", "scopeKind": ""}, {"name": "export async function parseCsvTextCost(text: string): Promise<ParseResult<CostIngestRow>> { parseCsvTextCost", "description": "Public function to parse CSV text into validated cost rows with error reporting.", "scope": "", "scopeKind": ""}, {"name": "export async function parseCsvResource(file: File): Promise<ParseResult<ResourceIngestRow>> { parseCsvResource", "description": "Public function to parse a CSV file into resource rows.", "scope": "", "scopeKind": ""}, {"name": "export async function parseCsvCost(file: File): Promise<ParseResult<CostIngestRow>> { parseCsvCost", "description": "Public function to parse a CSV file into cost rows.", "scope": "", "scopeKind": ""}], "calls": ["Papa.parse", "normalizeHeader", "parseNumberLike", "toIsoDate", "tryParseJson", "formatZodErrors", "ResourceIngestRowSchema.safeParse", "CostIngestRowSchema.safeParse"], "search-terms": ["csv parsing", "resource row validation", "cost row validation", "header normalization", "type coercion CSV", "CSV validation TypeScript"], "state": 2, "file_id": 45, "knowledge_revision": 122, "git_revision": "", "ctags": [{"_type": "tag", "name": "CostIngestRow", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^  type CostIngestRow,$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "ParseResult", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^  type ParseResult$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "ResourceIngestRow", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^  type ResourceIngestRow,$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "c", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^  const c = { ...candidate };$/", "language": "TypeScript", "kind": "constant", "scope": "coerceCostCandidate", "scopeKind": "function"}, {"_type": "tag", "name": "c", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^  const c = { ...candidate };$/", "language": "TypeScript", "kind": "constant", "scope": "coerceResourceCandidate", "scopeKind": "function"}, {"_type": "tag", "name": "coerceCostCandidate", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^function coerceCostCandidate(candidate: Record<string, unknown>): Record<string, unknown> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "coerceResourceCandidate", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^function coerceResourceCandidate(candidate: Record<string, unknown>): Record<string, unknown> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "coerced", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^    const coerced = coerceCostCandidate(normalized);$/", "language": "TypeScript", "kind": "constant", "scope": "parseCsvTextCost", "scopeKind": "function"}, {"_type": "tag", "name": "coerced", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^    const coerced = coerceResourceCandidate(normalized);$/", "language": "TypeScript", "kind": "constant", "scope": "parseCsvTextResource", "scopeKind": "function"}, {"_type": "tag", "name": "invalidRows", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^  const invalidRows: ParseResult<CostIngestRow>['invalidRows'] = [];$/", "language": "TypeScript", "kind": "constant", "scope": "parseCsvTextCost", "scopeKind": "function"}, {"_type": "tag", "name": "invalidRows", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^  const invalidRows: ParseResult<ResourceIngestRow>['invalidRows'] = [];$/", "language": "TypeScript", "kind": "constant", "scope": "parseCsvTextResource", "scopeKind": "function"}, {"_type": "tag", "name": "iso", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^    const iso = toIsoDate(c.created_at);$/", "language": "TypeScript", "kind": "constant", "scope": "coerceCostCandidate", "scopeKind": "function"}, {"_type": "tag", "name": "iso", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^    const iso = toIsoDate(c.created_at);$/", "language": "TypeScript", "kind": "constant", "scope": "coerceResourceCandidate", "scopeKind": "function"}, {"_type": "tag", "name": "iso", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^    const iso = toIsoDate(c.usage_date);$/", "language": "TypeScript", "kind": "constant", "scope": "coerceCostCandidate", "scopeKind": "function"}, {"_type": "tag", "name": "k", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^  for (const [k, v] of Object.entries(row)) {$/", "language": "TypeScript", "kind": "constant", "scope": "normalizeKeys", "scopeKind": "function"}, {"_type": "tag", "name": "nk", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^    const nk = normalizeHeader(k);$/", "language": "TypeScript", "kind": "constant", "scope": "normalizeKeys", "scopeKind": "function"}, {"_type": "tag", "name": "normalizeKeys", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^function normalizeKeys(row: Record<string, unknown>): Record<string, unknown> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "normalized", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^    const normalized = normalizeKeys(raw);$/", "language": "TypeScript", "kind": "constant", "scope": "parseCsvTextCost", "scopeKind": "function"}, {"_type": "tag", "name": "normalized", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^    const normalized = normalizeKeys(raw);$/", "language": "TypeScript", "kind": "constant", "scope": "parseCsvTextResource", "scopeKind": "function"}, {"_type": "tag", "name": "out", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^  const out: Record<string, unknown> = {};$/", "language": "TypeScript", "kind": "constant", "scope": "normalizeKeys", "scopeKind": "function"}, {"_type": "tag", "name": "parseCsvCost", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^export async function parseCsvCost(file: File): Promise<ParseResult<CostIngestRow>> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "parseCsvResource", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^export async function parseCsvResource(file: File): Promise<ParseResult<ResourceIngestRow>> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "parseCsvText", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^function parseCsvText(text: string): Array<Record<string, unknown>> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "parseCsvTextCost", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^export async function parseCsvTextCost(text: string): Promise<ParseResult<CostIngestRow>> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "parseCsvTextResource", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^export async function parseCsvTextResource(text: string): Promise<ParseResult<ResourceIngestRow>/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "parsed", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^      const parsed = tryParseJson<Record<string, string>>(c.tags);$/", "language": "TypeScript", "kind": "constant", "scope": "coerceResourceCandidate", "scopeKind": "function"}, {"_type": "tag", "name": "parsed", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^      const parsed = tryParseJson<string[]>(c.action_items);$/", "language": "TypeScript", "kind": "constant", "scope": "coerceResourceCandidate", "scopeKind": "function"}, {"_type": "tag", "name": "parsed", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^    const parsed = CostIngestRowSchema.safeParse(coerced);$/", "language": "TypeScript", "kind": "constant", "scope": "parseCsvTextCost", "scopeKind": "function"}, {"_type": "tag", "name": "parsed", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^    const parsed = ResourceIngestRowSchema.safeParse(coerced);$/", "language": "TypeScript", "kind": "constant", "scope": "parseCsvTextResource", "scopeKind": "function"}, {"_type": "tag", "name": "parsed", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^    const parsed = tryParseJson<Record<string, string>>(c.tags);$/", "language": "TypeScript", "kind": "constant", "scope": "coerceCostCandidate", "scopeKind": "function"}, {"_type": "tag", "name": "parsed", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^    const parsed = tryParseJson<string[]>(c.action_items);$/", "language": "TypeScript", "kind": "constant", "scope": "coerceCostCandidate", "scopeKind": "function"}, {"_type": "tag", "name": "res", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^  const res = Papa.parse<Record<string, string>>(text, {$/", "language": "TypeScript", "kind": "constant", "scope": "parseCsvText", "scopeKind": "function"}, {"_type": "tag", "name": "rows", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^  const rows = parseCsvText(text);$/", "language": "TypeScript", "kind": "constant", "scope": "parseCsvTextCost", "scopeKind": "function"}, {"_type": "tag", "name": "rows", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^  const rows = parseCsvText(text);$/", "language": "TypeScript", "kind": "constant", "scope": "parseCsvTextResource", "scopeKind": "function"}, {"_type": "tag", "name": "text", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^  const text = await file.text();$/", "language": "TypeScript", "kind": "constant", "scope": "parseCsvCost", "scopeKind": "function"}, {"_type": "tag", "name": "text", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^  const text = await file.text();$/", "language": "TypeScript", "kind": "constant", "scope": "parseCsvResource", "scopeKind": "function"}, {"_type": "tag", "name": "toRowNumber", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^function toRowNumber(indexZeroBased: number): number {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "v", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^  for (const [k, v] of Object.entries(row)) {$/", "language": "TypeScript", "kind": "constant", "scope": "normalizeKeys", "scopeKind": "function"}, {"_type": "tag", "name": "validRows", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^  const validRows: CostIngestRow[] = [];$/", "language": "TypeScript", "kind": "constant", "scope": "parseCsvTextCost", "scopeKind": "function"}, {"_type": "tag", "name": "validRows", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/csv.ts", "pattern": "/^  const validRows: ResourceIngestRow[] = [];$/", "language": "TypeScript", "kind": "constant", "scope": "parseCsvTextResource", "scopeKind": "function"}], "hash": "d1b81b13dc873f7c3c2696b8ecb69510", "format-version": 4, "code-base-name": "WebFrontend", "filename": "WebFrontend/src/lib/mapping/csv.ts", "revision_history": [{"122": ""}]}