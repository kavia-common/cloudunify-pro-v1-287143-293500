{"is_source_file": true, "format": "TypeScript", "description": "This file contains functions and types for parsing CSV and Excel files related to resource and cost data ingestion in a cloud management application. It includes utilities for normalizing headers, parsing tags, validating rows, and reading files as text or binary data.", "external_files": ["papaparse", "xlsx"], "external_methods": ["Papa.parse", "XLSX.read", "XLSX.utils.sheet_to_json"], "published": ["parseResourceFile", "parseCostFile", "ResourceIngestRow", "CostIngestRow", "ParseResult"], "classes": [], "methods": [{"name": "export async function parseResourceFile(file: File): Promise<ParseResult<ResourceIngestRow>> { parseResourceFile", "description": "Parses a file containing resource data in CSV or Excel format into valid and invalid resource rows.", "scope": "", "scopeKind": ""}, {"name": "export async function parseCostFile(file: File): Promise<ParseResult<CostIngestRow>> { parseCostFile", "description": "Parses a file containing cost data in CSV or Excel format into valid and invalid cost rows.", "scope": "", "scopeKind": ""}, {"name": "function normalizeHeader(h: string): string { normalizeHeader", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function parseTags(v: unknown): Record<string, string> | undefined { parseTags", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "async function readFileAsArrayBuffer(file: File): Promise<ArrayBuffer> { readFileAsArrayBuffer", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "async function readFileAsText(file: File): Promise<string> { readFileAsText", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "async function readRows(file: File): Promise<Record<string, unknown>[]> { readRows", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function toNumber(v: unknown): number | undefined { toNumber", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function validateCostRow(row: Record<string, unknown>): { ok: boolean; errors: string[]; out: Co/ validateCostRow", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function validateResourceRow(row: Record<string, unknown>): { ok: boolean; errors: string[]; out/ validateResourceRow", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["readRows", "validateResourceRow", "validateCostRow", "readFileAsText", "readFileAsArrayBuffer"], "search-terms": ["index.ts", "resource", "cost", "parse", "file", "ingest"], "state": 2, "file_id": 61, "knowledge_revision": 179, "git_revision": "", "ctags": [{"_type": "tag", "name": "CostIngestRow", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^export type CostIngestRow = Record<string, any> & {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "ParseInvalidRow", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^export type ParseInvalidRow = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "ParseResult", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^export type ParseResult<T> = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "ResourceIngestRow", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^export type ResourceIngestRow = Record<string, any> & {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "amount", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^  const amount = toNumber(row.cost ?? row.amount ?? row.cost_amount);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "buf", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^    const buf = await readFileAsArrayBuffer(file);$/", "language": "TypeScript", "kind": "constant", "scope": "readRows", "scopeKind": "function"}, {"_type": "tag", "name": "cd", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^  const cd = toNumber(row.cost_daily);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "cm", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^  const cm = toNumber(row.cost_monthly);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "costDate", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^  const costDate = String(row.cost_date || row.date || row.usage_date || '').trim();$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "errors", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^    const { ok, errors, out } = validateCostRow(row);$/", "language": "TypeScript", "kind": "constant", "scope": "parseCostFile", "scopeKind": "function"}, {"_type": "tag", "name": "errors", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^    const { ok, errors, out } = validateResourceRow(row);$/", "language": "TypeScript", "kind": "constant", "scope": "parseResourceFile", "scopeKind": "function"}, {"_type": "tag", "name": "errors", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^  const errors: string[] = [];$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "invalidRows", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^  const invalidRows: ParseInvalidRow[] = [];$/", "language": "TypeScript", "kind": "constant", "scope": "parseCostFile", "scopeKind": "function"}, {"_type": "tag", "name": "invalidRows", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^  const invalidRows: ParseInvalidRow[] = [];$/", "language": "TypeScript", "kind": "constant", "scope": "parseResourceFile", "scopeKind": "function"}, {"_type": "tag", "name": "json", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^    const json = XLSX.utils.sheet_to_json<Record<string, unknown>>(sheet, {$/", "language": "TypeScript", "kind": "constant", "scope": "readRows", "scopeKind": "function"}, {"_type": "tag", "name": "k", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^    const [k, ...rest] = p.split(\\/[:=]\\/g);$/", "language": "TypeScript", "kind": "constant", "scope": "parseTags", "scopeKind": "function"}, {"_type": "tag", "name": "key", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^    const key = (k || '').trim();$/", "language": "TypeScript", "kind": "constant", "scope": "parseTags", "scopeKind": "function"}, {"_type": "tag", "name": "n", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^  const n = typeof v === 'number' ? v : Number(String(v).replace(\\/,\\/g, ''));$/", "language": "TypeScript", "kind": "constant", "scope": "toNumber", "scopeKind": "function"}, {"_type": "tag", "name": "name", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^  const name = file.name.toLowerCase();$/", "language": "TypeScript", "kind": "constant", "scope": "readRows", "scopeKind": "function"}, {"_type": "tag", "name": "normalizeHeader", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^function normalizeHeader(h: string): string {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "obj", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^      const obj: Record<string, string> = {};$/", "language": "TypeScript", "kind": "constant", "scope": "parseTags", "scopeKind": "function"}, {"_type": "tag", "name": "ok", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^    const { ok, errors, out } = validateCostRow(row);$/", "language": "TypeScript", "kind": "constant", "scope": "parseCostFile", "scopeKind": "function"}, {"_type": "tag", "name": "ok", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^    const { ok, errors, out } = validateResourceRow(row);$/", "language": "TypeScript", "kind": "constant", "scope": "parseResourceFile", "scopeKind": "function"}, {"_type": "tag", "name": "out", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^      const out: Record<string, unknown> = {};$/", "language": "TypeScript", "kind": "constant", "scope": "readRows", "scopeKind": "function"}, {"_type": "tag", "name": "out", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^    const { ok, errors, out } = validateCostRow(row);$/", "language": "TypeScript", "kind": "constant", "scope": "parseCostFile", "scopeKind": "function"}, {"_type": "tag", "name": "out", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^    const { ok, errors, out } = validateResourceRow(row);$/", "language": "TypeScript", "kind": "constant", "scope": "parseResourceFile", "scopeKind": "function"}, {"_type": "tag", "name": "out", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^  const out: CostIngestRow = { ...(row as any) };$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "out", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^  const out: Record<string, string> = {};$/", "language": "TypeScript", "kind": "constant", "scope": "parseTags", "scopeKind": "function"}, {"_type": "tag", "name": "out", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^  const out: ResourceIngestRow = { ...(row as any) };$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "parseCostFile", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^export async function parseCostFile(file: File): Promise<ParseResult<CostIngestRow>> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "parseResourceFile", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^export async function parseResourceFile(file: File): Promise<ParseResult<ResourceIngestRow>> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "parseTags", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^function parseTags(v: unknown): Record<string, string> | undefined {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "parsed", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^    const parsed = JSON.parse(s);$/", "language": "TypeScript", "kind": "constant", "scope": "parseTags", "scopeKind": "function"}, {"_type": "tag", "name": "parsed", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^    const parsed = Papa.parse<Record<string, unknown>>(text, {$/", "language": "TypeScript", "kind": "constant", "scope": "readRows", "scopeKind": "function"}, {"_type": "tag", "name": "parts", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^  const parts = s.split(\\/[;,]+\\/g).map((p) => p.trim()).filter(Boolean);$/", "language": "TypeScript", "kind": "constant", "scope": "parseTags", "scopeKind": "function"}, {"_type": "tag", "name": "provider", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^  const provider = String(row.provider || row.cloud_provider || '').toLowerCase().trim();$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "provider", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^  const provider = String(row.provider || row.cloud_provider || row.vendor || '').toLowerCase()./", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "r", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^    const r = new FileReader();$/", "language": "TypeScript", "kind": "constant", "scope": "readFileAsArrayBuffer", "scopeKind": "function"}, {"_type": "tag", "name": "r", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^    const r = new FileReader();$/", "language": "TypeScript", "kind": "constant", "scope": "readFileAsText", "scopeKind": "function"}, {"_type": "tag", "name": "readFileAsArrayBuffer", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^async function readFileAsArrayBuffer(file: File): Promise<ArrayBuffer> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "readFileAsText", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^async function readFileAsText(file: File): Promise<string> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "readRows", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^async function readRows(file: File): Promise<Record<string, unknown>[]> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "resourceId", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^  const resourceId = String(row.resource_id || row.id || row.instance_id || '').trim();$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "rowNumber", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^    const rowNumber = idx + 2;$/", "language": "TypeScript", "kind": "constant", "scope": "parseCostFile", "scopeKind": "function"}, {"_type": "tag", "name": "rowNumber", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^    const rowNumber = idx + 2;$/", "language": "TypeScript", "kind": "constant", "scope": "parseResourceFile", "scopeKind": "function"}, {"_type": "tag", "name": "rows", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^  const rows = await readRows(file);$/", "language": "TypeScript", "kind": "constant", "scope": "parseCostFile", "scopeKind": "function"}, {"_type": "tag", "name": "rows", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^  const rows = await readRows(file);$/", "language": "TypeScript", "kind": "constant", "scope": "parseResourceFile", "scopeKind": "function"}, {"_type": "tag", "name": "s", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^  const s = String(v).trim();$/", "language": "TypeScript", "kind": "constant", "scope": "parseTags", "scopeKind": "function"}, {"_type": "tag", "name": "service", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^  const service = String(row.service_name || row.service || row.product || '').trim();$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "sheet", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^    const sheet = wb.Sheets[sheetName];$/", "language": "TypeScript", "kind": "constant", "scope": "readRows", "scopeKind": "function"}, {"_type": "tag", "name": "sheetName", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^    const sheet = wb.Sheets[sheetName];$/", "language": "TypeScript", "kind": "constant", "scope": "readRows", "scopeKind": "function"}, {"_type": "tag", "name": "sheetName", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^    const sheetName = wb.SheetNames[0];$/", "language": "TypeScript", "kind": "constant", "scope": "readRows", "scopeKind": "function"}, {"_type": "tag", "name": "tags", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^  const tags = parseTags(row.tags);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "text", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^    const text = await readFileAsText(file);$/", "language": "TypeScript", "kind": "constant", "scope": "readRows", "scopeKind": "function"}, {"_type": "tag", "name": "toNumber", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^function toNumber(v: unknown): number | undefined {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "v", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^  const n = typeof v === 'number' ? v : Number(String(v).replace(\\/,\\/g, ''));$/", "language": "TypeScript", "kind": "constant", "scope": "toNumber", "scopeKind": "function"}, {"_type": "tag", "name": "val", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^    const val = rest.join(':').trim();$/", "language": "TypeScript", "kind": "constant", "scope": "parseTags", "scopeKind": "function"}, {"_type": "tag", "name": "validRows", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^  const validRows: CostIngestRow[] = [];$/", "language": "TypeScript", "kind": "constant", "scope": "parseCostFile", "scopeKind": "function"}, {"_type": "tag", "name": "validRows", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^  const validRows: ResourceIngestRow[] = [];$/", "language": "TypeScript", "kind": "constant", "scope": "parseResourceFile", "scopeKind": "function"}, {"_type": "tag", "name": "validateCostRow", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^function validateCostRow(row: Record<string, unknown>): { ok: boolean; errors: string[]; out: Co/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "validateResourceRow", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^function validateResourceRow(row: Record<string, unknown>): { ok: boolean; errors: string[]; out/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "wb", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/index.ts", "pattern": "/^    const wb = XLSX.read(buf, { type: 'array' });$/", "language": "TypeScript", "kind": "constant", "scope": "readRows", "scopeKind": "function"}], "hash": "23060d01b03de0265af54105f565fde8", "format-version": 4, "code-base-name": "WebFrontend", "filename": "WebFrontend/src/lib/mapping/index.ts", "revision_history": [{"179": ""}]}