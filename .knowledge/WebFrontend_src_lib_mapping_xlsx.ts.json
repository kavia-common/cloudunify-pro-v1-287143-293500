{"is_source_file": true, "format": "TypeScript", "description": "This source file provides functions for parsing XLSX files into resource and cost data, including normalization, type coercion, and validation using schemas. It handles reading Excel workbooks, converting sheets to JSON objects, and exporting functions for both file and buffer inputs.", "external_files": ["xlsx", "./schemas"], "external_methods": ["XLSX.read", "XLSX.utils.sheet_to_json", "normalizeHeader", "parseNumberLike", "toIsoDate", "tryParseJson", "formatZodErrors", "ResourceIngestRowSchema", "CostIngestRowSchema"], "published": ["parseXlsxArrayBufferResource", "parseXlsxArrayBufferCost", "parseXlsxResource", "parseXlsxCost"], "classes": [], "methods": [{"name": "function toRowNumber(indexZeroBased: number): number { toRowNumber", "description": "Converts zero-based index to 1-based row number including header row.", "scope": "", "scopeKind": ""}, {"name": "function aoaToObjects(aoa: any[][]): Array<Record<string, unknown>> { aoaToObjects", "description": "Converts an array of arrays (AOA) representing an Excel sheet to an array of objects with normalized headers.", "scope": "", "scopeKind": ""}, {"name": "function coerceResourceCandidate(candidate: Record<string, unknown>): Record<string, unknown> { coerceResourceCandidate", "description": "Coerces and normalizes fields in resource candidate objects for type consistency.", "scope": "", "scopeKind": ""}, {"name": "function coerceCostCandidate(candidate: Record<string, unknown>): Record<string, unknown> { coerceCostCandidate", "description": "Coerces and normalizes fields in cost candidate objects for type consistency.", "scope": "", "scopeKind": ""}, {"name": "function parseXlsxArrayBufferToObjects(buffer: ArrayBuffer): Array<Record<string, unknown>> { parseXlsxArrayBufferToObjects", "description": "Reads an ArrayBuffer representing an XLSX file and converts its first sheet into an array of objects.", "scope": "", "scopeKind": ""}, {"name": "export async function parseXlsxArrayBufferResource(buffer: ArrayBuffer): Promise<ParseResult<Res/ parseXlsxArrayBufferResource", "description": "Parses XLSX buffer into validated resource rows, returning valid and invalid entries.", "scope": "", "scopeKind": ""}, {"name": "export async function parseXlsxArrayBufferCost(buffer: ArrayBuffer): Promise<ParseResult<CostIng/ parseXlsxArrayBufferCost", "description": "Parses XLSX buffer into validated cost rows, returning valid and invalid entries.", "scope": "", "scopeKind": ""}, {"name": "export async function parseXlsxResource(file: File): Promise<ParseResult<ResourceIngestRow>> { parseXlsxResource", "description": "Reads a File object, converts it to an ArrayBuffer, and parses into resource data.", "scope": "", "scopeKind": ""}, {"name": "export async function parseXlsxCost(file: File): Promise<ParseResult<CostIngestRow>> { parseXlsxCost", "description": "Reads a File object, converts it to an ArrayBuffer, and parses into cost data.", "scope": "", "scopeKind": ""}], "calls": ["XLSX.read", "XLSX.utils.sheet_to_json", "normalizeHeader", "parseNumberLike", "toIsoDate", "tryParseJson", "formatZodErrors", "ResourceIngestRowSchema.safeParse", "CostIngestRowSchema.safeParse"], "search-terms": ["xlsx parsing", "ResourceIngestRow", "CostIngestRow", "schema validation", "header normalization", "Excel file parsing", "type coercion"], "state": 2, "file_id": 46, "knowledge_revision": 123, "git_revision": "", "ctags": [{"_type": "tag", "name": "CostIngestRow", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^  type CostIngestRow,$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "ParseResult", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^  type ParseResult$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "ResourceIngestRow", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^  type ResourceIngestRow,$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "aoa", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^  const aoa: any[][] = XLSX.utils.sheet_to_json(ws, { header: 1, defval: '' }) as any[][];$/", "language": "TypeScript", "kind": "constant", "scope": "parseXlsxArrayBufferToObjects", "scopeKind": "function"}, {"_type": "tag", "name": "aoaToObjects", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^function aoaToObjects(aoa: any[][]): Array<Record<string, unknown>> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "buffer", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^  const buffer = await file.arrayBuffer();$/", "language": "TypeScript", "kind": "constant", "scope": "parseXlsxCost", "scopeKind": "function"}, {"_type": "tag", "name": "buffer", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^  const buffer = await file.arrayBuffer();$/", "language": "TypeScript", "kind": "constant", "scope": "parseXlsxResource", "scopeKind": "function"}, {"_type": "tag", "name": "c", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^      const key = keys[c];$/", "language": "TypeScript", "kind": "constant", "scope": "aoaToObjects", "scopeKind": "function"}, {"_type": "tag", "name": "c", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^  const c = { ...candidate };$/", "language": "TypeScript", "kind": "constant", "scope": "coerceCostCandidate", "scopeKind": "function"}, {"_type": "tag", "name": "c", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^  const c = { ...candidate };$/", "language": "TypeScript", "kind": "constant", "scope": "coerceResourceCandidate", "scopeKind": "function"}, {"_type": "tag", "name": "coerceCostCandidate", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^function coerceCostCandidate(candidate: Record<string, unknown>): Record<string, unknown> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "coerceResourceCandidate", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^function coerceResourceCandidate(candidate: Record<string, unknown>): Record<string, unknown> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "coerced", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^    const coerced = coerceCostCandidate(raw);$/", "language": "TypeScript", "kind": "constant", "scope": "parseXlsxArrayBufferCost", "scopeKind": "function"}, {"_type": "tag", "name": "coerced", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^    const coerced = coerceResourceCandidate(raw);$/", "language": "TypeScript", "kind": "constant", "scope": "parseXlsxArrayBufferResource", "scopeKind": "function"}, {"_type": "tag", "name": "invalidRows", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^  const invalidRows: ParseResult<CostIngestRow>['invalidRows'] = [];$/", "language": "TypeScript", "kind": "constant", "scope": "parseXlsxArrayBufferCost", "scopeKind": "function"}, {"_type": "tag", "name": "invalidRows", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^  const invalidRows: ParseResult<ResourceIngestRow>['invalidRows'] = [];$/", "language": "TypeScript", "kind": "constant", "scope": "parseXlsxArrayBufferResource", "scopeKind": "function"}, {"_type": "tag", "name": "iso", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^    const iso = toIsoDate(c.created_at);$/", "language": "TypeScript", "kind": "constant", "scope": "coerceResourceCandidate", "scopeKind": "function"}, {"_type": "tag", "name": "iso", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^    const iso = toIsoDate(c.usage_date);$/", "language": "TypeScript", "kind": "constant", "scope": "coerceCostCandidate", "scopeKind": "function"}, {"_type": "tag", "name": "key", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^      const key = keys[c];$/", "language": "TypeScript", "kind": "constant", "scope": "aoaToObjects", "scopeKind": "function"}, {"_type": "tag", "name": "keys", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^  const keys = rawHeaders.map(normalizeHeader);$/", "language": "TypeScript", "kind": "constant", "scope": "aoaToObjects", "scopeKind": "function"}, {"_type": "tag", "name": "obj", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^    const obj: Record<string, unknown> = {};$/", "language": "TypeScript", "kind": "constant", "scope": "aoaToObjects", "scopeKind": "function"}, {"_type": "tag", "name": "parseXlsxArrayBufferCost", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^export async function parseXlsxArrayBufferCost(buffer: ArrayBuffer): Promise<ParseResult<CostIng/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "parseXlsxArrayBufferResource", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^export async function parseXlsxArrayBufferResource(buffer: ArrayBuffer): Promise<ParseResult<Res/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "parseXlsxArrayBufferToObjects", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^function parseXlsxArrayBufferToObjects(buffer: ArrayBuffer): Array<Record<string, unknown>> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "parseXlsxCost", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^export async function parseXlsxCost(file: File): Promise<ParseResult<CostIngestRow>> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "parseXlsxResource", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^export async function parseXlsxResource(file: File): Promise<ParseResult<ResourceIngestRow>> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "parsed", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^      const parsed = tryParseJson<Record<string, string>>(c.tags);$/", "language": "TypeScript", "kind": "constant", "scope": "coerceResourceCandidate", "scopeKind": "function"}, {"_type": "tag", "name": "parsed", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^      const parsed = tryParseJson<string[]>(c.action_items);$/", "language": "TypeScript", "kind": "constant", "scope": "coerceResourceCandidate", "scopeKind": "function"}, {"_type": "tag", "name": "parsed", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^    const parsed = CostIngestRowSchema.safeParse(coerced);$/", "language": "TypeScript", "kind": "constant", "scope": "parseXlsxArrayBufferCost", "scopeKind": "function"}, {"_type": "tag", "name": "parsed", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^    const parsed = ResourceIngestRowSchema.safeParse(coerced);$/", "language": "TypeScript", "kind": "constant", "scope": "parseXlsxArrayBufferResource", "scopeKind": "function"}, {"_type": "tag", "name": "parsed", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^    const parsed = tryParseJson<Record<string, string>>(c.tags);$/", "language": "TypeScript", "kind": "constant", "scope": "coerceCostCandidate", "scopeKind": "function"}, {"_type": "tag", "name": "parsed", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^    const parsed = tryParseJson<string[]>(c.action_items);$/", "language": "TypeScript", "kind": "constant", "scope": "coerceCostCandidate", "scopeKind": "function"}, {"_type": "tag", "name": "r", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^    const row = aoa[r] || [];$/", "language": "TypeScript", "kind": "constant", "scope": "aoaToObjects", "scopeKind": "function"}, {"_type": "tag", "name": "rawHeaders", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^  const rawHeaders = (aoa[0] || []).map((h) => String(h ?? ''));$/", "language": "TypeScript", "kind": "constant", "scope": "aoaToObjects", "scopeKind": "function"}, {"_type": "tag", "name": "row", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^    const row = aoa[r] || [];$/", "language": "TypeScript", "kind": "constant", "scope": "aoaToObjects", "scopeKind": "function"}, {"_type": "tag", "name": "rows", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^  const rows = parseXlsxArrayBufferToObjects(buffer);$/", "language": "TypeScript", "kind": "constant", "scope": "parseXlsxArrayBufferCost", "scopeKind": "function"}, {"_type": "tag", "name": "rows", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^  const rows = parseXlsxArrayBufferToObjects(buffer);$/", "language": "TypeScript", "kind": "constant", "scope": "parseXlsxArrayBufferResource", "scopeKind": "function"}, {"_type": "tag", "name": "rows", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^  const rows: Array<Record<string, unknown>> = [];$/", "language": "TypeScript", "kind": "constant", "scope": "aoaToObjects", "scopeKind": "function"}, {"_type": "tag", "name": "sheetName", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^  const sheetName = wb.SheetNames[0];$/", "language": "TypeScript", "kind": "constant", "scope": "parseXlsxArrayBufferToObjects", "scopeKind": "function"}, {"_type": "tag", "name": "sheetName", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^  const ws = wb.Sheets[sheetName];$/", "language": "TypeScript", "kind": "constant", "scope": "parseXlsxArrayBufferToObjects", "scopeKind": "function"}, {"_type": "tag", "name": "toRowNumber", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^function toRowNumber(indexZeroBased: number): number {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "validRows", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^  const validRows: CostIngestRow[] = [];$/", "language": "TypeScript", "kind": "constant", "scope": "parseXlsxArrayBufferCost", "scopeKind": "function"}, {"_type": "tag", "name": "validRows", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^  const validRows: ResourceIngestRow[] = [];$/", "language": "TypeScript", "kind": "constant", "scope": "parseXlsxArrayBufferResource", "scopeKind": "function"}, {"_type": "tag", "name": "wb", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^  const wb = XLSX.read(buffer, { type: 'array', cellDates: true });$/", "language": "TypeScript", "kind": "constant", "scope": "parseXlsxArrayBufferToObjects", "scopeKind": "function"}, {"_type": "tag", "name": "ws", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293500/WebFrontend/src/lib/mapping/xlsx.ts", "pattern": "/^  const ws = wb.Sheets[sheetName];$/", "language": "TypeScript", "kind": "constant", "scope": "parseXlsxArrayBufferToObjects", "scopeKind": "function"}], "hash": "145a58c0ecbcdae273f6acb8c3edf439", "format-version": 4, "code-base-name": "WebFrontend", "filename": "WebFrontend/src/lib/mapping/xlsx.ts", "revision_history": [{"123": ""}]}